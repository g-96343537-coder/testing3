<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>äºŒå¹´çº§è¯­æ–‡è¶£å‘³ç»ƒä¹ </title>
<style>
  :root{
    --card-bg: rgba(255,255,255,0.95);
    --text:#4a2c2a;
    --blue:#64b5f6;
    --green:#81c784;
    --red:#e57373;
    --orange:#ff7043;
  }
  body{
    margin:0;padding:0;
    font-family:'Ma Shan Zheng','Comic Neue','Microsoft YaHei',sans-serif;
    background-size:cover;background-position:center;
    background-image:url('https://wallpaperset.com/w/full/5/9/b/143417.jpg');
    color:var(--text);
    min-height:100vh;
  }
  h1{text-align:center;color:#ff7043;text-shadow:2px 2px 0 #ffe0b2;margin:16px 0 6px;font-size:2rem}
  
  .wrap{max-width:820px;margin:auto;padding:12px}
  
  /* ====== é€šç”¨å¡ç‰‡æ ·å¼ ====== */
  .card{
    background:var(--card-bg);
    border-radius:20px;
    padding:18px;
    margin:16px auto;
    box-shadow:0 10px 30px rgba(0,0,0,0.1);
    transition:transform 260ms ease;
  }
  .card:hover{transform:translateY(-3px)}

  /* ====== 1. å¼€å§‹ç”»é¢æ ·å¼ ====== */
  #start-screen {
    max-width: 450px;
    text-align: center;
    padding: 30px 20px;
    margin-top: 50px;
  }
  .input-group {
    margin-bottom: 20px;
    text-align: left;
  }
  .input-group label {
    display: block;
    font-size: 1.2rem;
    margin-bottom: 8px;
    font-weight: bold;
    color: #5d4037;
  }
  .input-group input, .input-group select {
    width: 100%;
    padding: 12px;
    font-size: 1.1rem;
    border: 2px solid #ffcc80;
    border-radius: 12px;
    box-sizing: border-box;
    outline: none;
    font-family: inherit;
    background-color: #fff8e1; /* æ·¡é»„è‰²èƒŒæ™¯ */
  }
  .input-group input:focus, .input-group select:focus {
    border-color: var(--orange);
    background-color: #fff;
  }
  #startBtn {
    font-size: 1.5rem;
    padding: 12px 40px;
    background: linear-gradient(to bottom, #ffcc80, #ffb74d);
    color: #4e342e;
    border: none;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 4px 0 #f57c00;
    transition: transform 0.1s;
    margin-top: 10px;
  }
  #startBtn:active { transform: translateY(3px); box-shadow: none; }

  /* ====== 2. æµ‹éªŒå†…å®¹æ ·å¼ (åˆå§‹éšè—) ====== */
  #quiz-content { display: none; }
  
  #student-info-bar {
    background: rgba(255,255,255,0.9);
    padding: 10px 20px;
    border-radius: 15px;
    margin-bottom: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: bold;
    color: #3e2723;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
  }

  /* ====== é¢˜ç›®æ ·å¼ ====== */
  .q{font-size:1.3rem;margin-bottom:12px; line-height: 1.6;}
  .choices{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}
  .choice{
    min-width:120px;
    padding:10px 16px;
    border:none;border-radius:16px;
    font-size:1rem;
    cursor:pointer;
    color:#3e2723;
    background:linear-gradient(to bottom,#fff3e0,#ffe0b2);
    box-shadow:0 4px 0 rgba(0,0,0,0.1);
    transition:transform .2s, background .2s;
  }
  .choice:hover{transform:translateY(-2px)}
  .choice:active{transform:translateY(2px); box-shadow:none;}
  
  .choice.correct{background:linear-gradient(to bottom,#a5d6a7,#66bb6a);color:#003300; box-shadow:none; cursor:default;}
  .choice.wrong{background:linear-gradient(to bottom,#ef9a9a,#e57373);color:#660000; box-shadow:none; cursor:default;}
  
  /* ç¦ç”¨çŠ¶æ€ */
  .choice:disabled { cursor: default; }

  /* åº•éƒ¨ç»Ÿè®¡æ¡ */
  .result-bar {
    position: sticky;
    bottom: 20px;
    background: rgba(255, 255, 255, 0.95);
    padding: 15px;
    border-radius: 50px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    text-align: center;
    font-weight:bold;
    font-size:1.3rem;
    color: #d84315;
    border: 2px solid #ffab91;
    max-width: 400px;
    margin: 20px auto;
    z-index: 100;
  }

  @keyframes flashGreen{0%{transform:scale(1)}40%{transform:scale(1.06)}100%{transform:scale(1)}}
  .correct-flash{animation:flashGreen 700ms ease;}
</style>
</head>
<body>
  <h1>ğŸŒˆ äºŒå¹´çº§è¯­æ–‡è¶£å‘³ç»ƒä¹ </h1>
  
  <div class="wrap">
    
    <div id="start-screen" class="card">
        <h2 style="color:var(--orange); margin-top:0;">æ¬¢è¿å°æœ‹å‹ï¼ğŸ‘‹</h2>
        <div class="input-group">
            <label for="student-name">å§“å (Nama)ï¼š</label>
            <input type="text" id="student-name" placeholder="è¯·è¾“å…¥ä½ çš„åå­—..." autocomplete="off">
        </div>
        <div class="input-group">
            <label for="student-class">ç­çº§ (Kelas)ï¼š</label>
            <select id="student-class">
                <option value="">è¯·é€‰æ‹©ç­çº§</option>
                <option value="2M">2M</option>
                <option value="2K">2K</option>
                <option value="2B">2B</option>
                <option value="2H">2H</option>
                <option value="2J">2J</option>
            </select>
        </div>
        <button id="startBtn">å¼€å§‹ç»ƒä¹ </button>
    </div>

    <div id="quiz-content">
        <div id="student-info-bar">
            <span id="display-name">å­¦ç”Ÿï¼š-</span>
            <span id="display-class">ç­çº§ï¼š-</span>
        </div>
        <div id="pageArea"></div>
        <div class="result-bar" id="score">ğŸŒŸ æ­£ç¡®ï¼š0 / å·²ç­”ï¼š0</div>
    </div>

  </div>

<script>
// ====== ä½ çš„æ–° Google Apps Script ç½‘å€ ======
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzAhc5FYUFqbeJhZY0U1PnMsrZMbNv8VgtyE7HB-MNxQfV-GRW0VsX3GLM55hxPS3GGZQ/exec";

// ====== é¢˜ç›®æ•°æ® ======
const questions = [
  {q:'å¼Ÿå¼ŸæŠŠä¹¦æˆ¿é‡Œçš„ä¹¦æœ¬å’Œæ–‡å…·æ”¶æ‹¾å¾—éå¸¸______ã€‚',o:['å±é™©','æ•´é½','åµé—¹'],a:1},
  {q:'è¿™é‡Œçš„ç©ºæ°”æ¸…æ–°ï¼Œç¯å¢ƒä¼˜ç¾ï¼Œè®©äººæ„Ÿåˆ°å¾ˆ______ã€‚',o:['èˆ’æœ','å½¢çŠ¶','åšæŒ'],a:0},
  {q:'ä¸€è‰˜å·¨å¤§çš„______æ­£åœ¨å¤§æµ·ä¸Šæ…¢æ…¢åœ°èˆªè¡Œã€‚',o:['è½®èˆ¹','é‡è‰','å²¸è¾¹'],a:0},
  {q:'åªè¦åŒå­¦ä»¬äº’ç›¸______ï¼Œä¸€å®šèƒ½æŠŠè¿™é—´è¯¾å®¤æ‰“æ‰«å¹²å‡€ã€‚',o:['ç¦»å¼€','å¿˜è®°','åˆä½œ'],a:2},
  {q:'å¦ˆå¦ˆçš„æ€€æŠ±å¾ˆ______ï¼Œè®©æˆ‘æ„Ÿåˆ°æ— æ¯”å®‰å¿ƒã€‚',o:['æ¸©æš–','åµé—¹','æ—è¾¹'],a:0},
  {q:'å‡ºé—¨å‰ï¼Œåƒä¸‡åˆ«______è¦æŠŠé—¨çª—å…³å¥½ã€‚',o:['å­¦ä¹ ','è¯·æ±‚','å¿˜è®°'],a:2},
  {q:'å›¾ä¹¦é¦†æ˜¯é˜…è¯»çš„åœ°æ–¹ï¼Œæˆ‘ä»¬ä¸å¯ä»¥åœ¨é‡Œé¢______ã€‚',o:['æ ½ç§','åµé—¹','æŒ‚èµ·'],a:1},
  {q:'æˆ‘ä»¬è¦å‘å‹¤åŠ³çš„èš‚èš______ï¼Œæ¯å¤©åŠªåŠ›å·¥ä½œã€‚',o:['å­¦ä¹ ','é‡‡æ‘˜','å½¢çŠ¶'],a:0},
  {q:'å¼Ÿå¼Ÿç”Ÿç—…äº†ï¼Œä»–______å¦ˆå¦ˆå¸¦ä»–å»çœ‹åŒ»ç”Ÿã€‚',o:['åšæŒ','è¯·æ±‚','æ¸©æš–'],a:1},
  {q:'æ˜¥èŠ‚åˆ°äº†ï¼Œå®¶å®¶æˆ·æˆ·éƒ½åœ¨é—¨å‰______äº†çº¢ç¯ç¬¼ã€‚',o:['æŒ‚èµ·','ç¦»å¼€','æ ½ç§'],a:0},
  {q:'æˆ‘ååœ¨å°æ˜çš„______ï¼Œæˆ‘ä»¬ç»å¸¸ä¸€èµ·è®¨è®ºåŠŸè¯¾ã€‚',o:['ç”±æ¥','å±é™©','æ—è¾¹'],a:2},
  {q:'è¯·çˆ±æŠ¤èŠ±è‰æ ‘æœ¨ï¼Œä¸è¦éšæ„______å…¬å›­é‡Œçš„èŠ±æœµã€‚',o:['é‡‡æ‘˜','å­¦ä¹ ','åˆä½œ'],a:0},
  {q:'çˆ·çˆ·åœ¨å±‹åçš„ç©ºåœ°ä¸Š______äº†å‡ æ£µçº¢æ¯›ä¸¹æ ‘ã€‚',o:['è½®èˆ¹','èˆ’æœ','æ ½ç§'],a:2},
  {q:'å†œå¤«åœ¨çƒˆæ—¥ä¸‹è¾›è‹¦åœ°æ‹”é™¤ç”°é‡Œçš„______ã€‚',o:['å²¸è¾¹','é‡è‰','å½¢çŠ¶'],a:1},
  {q:'å‚æ™šæ—¶åˆ†ï¼Œè®¸å¤šæ¸”èˆ¹é™†ç»­åœé åœ¨______ã€‚',o:['å²¸è¾¹','æ—è¾¹','å±é™©'],a:0},
  {q:'æ”¾å­¦é“ƒå£°å“äº†ï¼ŒåŒå­¦ä»¬æ”¶æ‹¾å¥½ä¹¦åŒ…______å­¦æ ¡ã€‚',o:['æŒ‚èµ·','è¯·æ±‚','ç¦»å¼€'],a:2},
  {q:'å¤©ä¸Šçš„ç™½äº‘______å¤šå˜ï¼Œæœ‰æ—¶å€™åƒæ£‰èŠ±ç³–ï¼Œæœ‰æ—¶å€™åƒå°ç‹—ã€‚',o:['å½¢çŠ¶','ç”±æ¥','æ¸©æš–'],a:0},
  {q:'æ— è®ºé‡åˆ°ä»€ä¹ˆå›°éš¾ï¼Œæˆ‘ä»¬éƒ½è¦______åˆ°åº•ï¼Œä¸å¯åŠé€”è€ŒåºŸã€‚',o:['åšæŒ','å¿˜è®°','åµé—¹'],a:0},
  {q:'è€å¸ˆæ­£åœ¨å‘åŒå­¦ä»¬è®²è§£ç«¯åˆèŠ‚çš„______å’Œä¼ è¯´ã€‚',o:['é‡è‰','è½®èˆ¹','ç”±æ¥'],a:2},
  {q:'åœ¨é©¬è·¯ä¸Šè¸¢çƒæ˜¯éå¸¸______çš„è¡Œä¸ºï¼Œä¸€å®šè¦é¿å…ã€‚',o:['å±é™©','æ•´é½','èˆ’æœ'],a:0}
];

// ====== å…¨å±€å˜é‡ ======
const selected = Array(questions.length).fill(null);
const answers = Array(questions.length).fill(null);
let studentName = "";
let studentClass = "";

// ====== DOM å…ƒç´  ======
const startScreen = document.getElementById('start-screen');
const quizContent = document.getElementById('quiz-content');
const startBtn = document.getElementById('startBtn');
const nameInput = document.getElementById('student-name');
const classInput = document.getElementById('student-class');
const displayName = document.getElementById('display-name');
const displayClass = document.getElementById('display-class');
const pageArea = document.getElementById('pageArea');
const scoreEl = document.getElementById('score');

// ====== 1. å¼€å§‹æŒ‰é’®é€»è¾‘ ======
startBtn.addEventListener('click', () => {
    const sName = nameInput.value.trim();
    const sClass = classInput.value;

    if (!sName) {
        alert("å°æœ‹å‹ï¼Œè¯·è¾“å…¥ä½ çš„åå­—å“¦ï¼");
        return;
    }
    if (!sClass) {
        alert("è¯·é€‰æ‹©ä½ çš„ç­çº§ï¼");
        return;
    }

    studentName = sName;
    studentClass = sClass;

    // åˆ‡æ¢ç•Œé¢
    startScreen.style.display = 'none';
    quizContent.style.display = 'block';

    // æ˜¾ç¤ºä¿¡æ¯
    displayName.textContent = `å­¦ç”Ÿï¼š${studentName}`;
    displayClass.textContent = `ç­çº§ï¼š${studentClass}`;

    // æ¸²æŸ“é¢˜ç›®
    render();
});

// ====== 2. æ¸²æŸ“ä¸ç­”é¢˜é€»è¾‘ ======
function render(){
  pageArea.innerHTML='';
  questions.forEach((q,i)=>{
    const card=document.createElement('div');
    card.className='card';
    
    // é¢˜ç›®æ–‡æœ¬
    const qText=document.createElement('div');
    qText.className='q';
    qText.textContent=`${i+1}. ${q.q}`;
    card.appendChild(qText);

    // é€‰é¡¹å®¹å™¨
    const opts=document.createElement('div');
    opts.className='choices';
    
    q.o.forEach((opt,idx)=>{
      const b=document.createElement('button');
      b.className='choice';
      b.textContent=opt;
      b.addEventListener('click',()=>{
        if(answers[i]!==null) return; // é˜²æ­¢é‡å¤ç­”é¢˜
        selected[i]=idx;
        checkAnswer(i,card,opts);
      });
      opts.appendChild(b);
    });
    card.appendChild(opts);
    pageArea.appendChild(card);
  });
}

function checkAnswer(i,card,opts){
  const q=questions[i];
  const chosen=selected[i];
  const btns=opts.querySelectorAll('.choice');
  
  // ç¦ç”¨æ‰€æœ‰æŒ‰é’®
  btns.forEach(b=>b.disabled=true);

  if(chosen===q.a){
    // ç­”å¯¹äº†
    btns[chosen].classList.add('correct');
    answers[i]=true;
  }else{
    // ç­”é”™äº†
    btns[chosen].classList.add('wrong');
    const correctBtn=btns[q.a];
    correctBtn.classList.add('correct-flash');
    setTimeout(()=>{
      correctBtn.classList.remove('correct-flash');
      correctBtn.classList.add('correct');
    },700);
    answers[i]=false;
  }
  updateScore();
  
  // æ£€æŸ¥æ˜¯å¦å…¨éƒ¨ç­”å®Œ
  checkCompletion();
}

function updateScore(){
  const correctCount=answers.filter(v=>v===true).length;
  const answeredCount=answers.filter(v=>v!==null).length;
  // å¦‚æœè¿˜åœ¨ç­”é¢˜ä¸­ï¼Œæ˜¾ç¤ºè¿›åº¦
  if(answeredCount < questions.length) {
      scoreEl.textContent=`ğŸŒŸ æ­£ç¡®ï¼š${correctCount} / å·²ç­”ï¼š${answeredCount} (å…±${questions.length}é¢˜)`;
  }
}

// ====== 3. æäº¤æ•°æ®åˆ° Google Sheet (æ–°å¢) ======
function submitToGoogleSheet(name, className, score, total) {
    // 1. æ›´æ–°UIæ˜¾ç¤ºæ­£åœ¨æäº¤
    scoreEl.style.backgroundColor = "#fff3e0";
    scoreEl.innerHTML = `â³ æ­£åœ¨æäº¤æˆç»©ï¼Œè¯·ç¨å€™...`;

    // 2. å‡†å¤‡æ•°æ®
    const formData = new URLSearchParams();
    formData.append("name", name);
    formData.append("class", className);
    formData.append("score", score);
    formData.append("total", total);

    // 3. å‘é€è¯·æ±‚
    fetch(SCRIPT_URL, {
        method: 'POST',
        body: formData
    })
    .then(response => response.text())
    .then(text => {
        // æˆåŠŸåçš„å¤„ç†
        scoreEl.style.backgroundColor = "#e8f5e9";
        scoreEl.style.borderColor = "#4caf50";
        scoreEl.style.color = "#1b5e20";
        scoreEl.innerHTML = `âœ… æˆç»©å·²å­˜æ¡£ï¼å¾—åˆ†ï¼š${score}/${total}`;
        
        alert(`ğŸ‰ æ­å–œ ${name} (${className})ï¼\n\nä½ å®Œæˆäº†æ‰€æœ‰ç»ƒä¹ ã€‚\næ€»å¾—åˆ†ï¼š${score} / ${total}\næˆç»©å·²ç»å‘ç»™è€å¸ˆå•¦ï¼`);
    })
    .catch(error => {
        // é”™è¯¯å¤„ç†
        console.error('Error:', error);
        scoreEl.innerHTML = `âš ï¸ æäº¤é‡åˆ°ç½‘ç»œé—®é¢˜ï¼Œè¯·æˆªå›¾ã€‚`;
        alert(`åšå®Œäº†ï¼Œä½†æ˜¯ç½‘ç»œæœ‰ç‚¹å¡ã€‚\n\nè¯·æŠŠè¿™ä¸ªç”»é¢æˆªå›¾å‘ç»™è€å¸ˆï¼š\nå§“åï¼š${name}\nåˆ†æ•°ï¼š${score}/${total}`);
    });
}

function checkCompletion() {
    const answeredCount = answers.filter(v => v !== null).length;
    if (answeredCount === questions.length) {
        const correctCount = answers.filter(v => v === true).length;
        
        // å»¶è¿Ÿ800æ¯«ç§’ï¼Œè®©å­¦ç”Ÿçœ‹å®Œæœ€åä¸€é¢˜çš„æ­£ç¡®ä¸å¦ï¼Œå†æäº¤
        setTimeout(() => {
            submitToGoogleSheet(studentName, studentClass, correctCount, questions.length);
        }, 800);
    }
}
</script>
</body>
</html>
