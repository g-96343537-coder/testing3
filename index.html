<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>å››å¹´çº§æˆè¯­ç»ƒä¹ </title>
<style>
  :root{
    --card-bg: rgba(255,255,255,0.95);
    --text:#4a2c2a;
    --blue:#64b5f6;
    --green:#81c784;
    --red:#e57373;
    --orange:#ff7043;
    --brown:#5d4037;
  }
  body{
    margin:0;padding:0;
    font-family:'Ma Shan Zheng','KaiTi','Microsoft YaHei',serif;
    background-size:cover;background-position:center;
    background-image:url('https://png.pngtree.com/background/20230403/original/pngtree-mountains-and-rivers-ancient-architecture-chinese-style-background-picture-image_2269854.jpg');
    background-attachment: fixed;
    color:var(--text);
    min-height:100vh;
  }
  h1{text-align:center;color:#bf360c;text-shadow:2px 2px 0 #ffe0b2;margin:20px 0 10px;font-size:2.2rem}
  
  .wrap{max-width:820px;margin:auto;padding:12px}
  
  /* ====== é€šç”¨å¡ç‰‡æ ·å¼ ====== */
  .card{
    background:var(--card-bg);
    border-radius:15px;
    padding:20px;
    margin:16px auto;
    box-shadow:0 8px 25px rgba(0,0,0,0.15);
    border: 1px solid #e0e0e0;
    transition:transform 260ms ease;
  }
  .card:hover{transform:translateY(-3px)}

  /* ====== 1. å¼€å§‹ç”»é¢æ ·å¼ ====== */
  #start-screen {
    max-width: 500px;
    text-align: center;
    padding: 40px 30px;
    margin-top: 60px;
    background: rgba(255, 255, 255, 0.96);
    border: 2px solid #d84315;
  }
  
  .input-group {
    margin-bottom: 25px;
    text-align: left;
  }
  .input-group label {
    display: block;
    font-size: 1.3rem;
    margin-bottom: 8px;
    font-weight: bold;
    color: var(--brown);
  }
  .input-group input, .input-group select {
    width: 100%;
    padding: 12px;
    font-size: 1.1rem;
    border: 2px solid #ffcc80;
    border-radius: 10px;
    box-sizing: border-box;
    outline: none;
    font-family: inherit;
    background-color: #fff8e1;
  }
  .input-group input:focus, .input-group select:focus {
    border-color: #ff6f00;
    background-color: #fff;
  }
  
  #startBtn {
    font-size: 1.6rem;
    padding: 12px 60px;
    background: linear-gradient(to bottom, #ff7043, #d84315);
    color: white;
    border: none;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 4px 0 #bf360c;
    transition: transform 0.1s;
    margin-top: 15px;
    font-family: inherit;
  }
  #startBtn:active { transform: translateY(3px); box-shadow: none; }

  /* ====== 2. ç»ƒä¹ å†…å®¹æ ·å¼ (åˆå§‹éšè—) ====== */
  #quiz-content { display: none; }

  #student-info-bar {
    background: rgba(255, 252, 240, 0.95);
    padding: 12px 25px;
    border-radius: 12px;
    margin-bottom: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: bold;
    color: var(--brown);
    border-left: 5px solid #d84315;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    font-size: 1.1rem;
  }

  /* ====== é¢˜ç›®ä¸é€‰é¡¹ ====== */
  .q{font-size:1.4rem;margin-bottom:15px; line-height: 1.6;}
  .choices{display:flex;flex-wrap:wrap;gap:12px;justify-content:center}
  .choice{
    min-width:130px;
    padding:12px 20px;
    border:none;border-radius:12px;
    font-size:1.1rem;
    cursor:pointer;
    color:#3e2723;
    background:linear-gradient(to bottom,#fff3e0,#ffe0b2);
    box-shadow:0 5px 0 rgba(0,0,0,0.1);
    transition:transform .2s, background .2s;
    font-family: inherit;
  }
  .choice:hover{transform:translateY(-2px)}
  .choice:active{transform:translateY(2px); box-shadow:none;}
  
  .choice.correct{background:linear-gradient(to bottom,#a5d6a7,#66bb6a);color:#003300; box-shadow:none; cursor:default;}
  .choice.wrong{background:linear-gradient(to bottom,#ef9a9a,#e57373);color:#660000; box-shadow:none; cursor:default;}
  
  .choice:disabled { cursor: default; }

  /* åº•éƒ¨ç»Ÿè®¡æ¡ */
  .result-bar {
    position: sticky;
    bottom: 20px;
    background: rgba(255, 255, 255, 0.95);
    padding: 15px;
    border-radius: 50px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    text-align: center;
    font-weight:bold;
    font-size:1.3rem;
    color: #bf360c;
    border: 2px solid #ffab91;
    max-width: 400px;
    margin: 20px auto;
    z-index: 100;
  }

  @keyframes flashGreen{0%{transform:scale(1)}40%{transform:scale(1.06)}100%{transform:scale(1)}}
  .correct-flash{animation:flashGreen 700ms ease;}
</style>
</head>
<body>
  <h1>ğŸŒˆ å››å¹´çº§æˆè¯­ç»ƒä¹ </h1>
  
  <div class="wrap">
    
    <div id="start-screen" class="card">
        <h2 style="color:#d84315; margin-top:0;">æ¬¢è¿è¿›å…¥æˆè¯­ä¹å›­ ğŸ®</h2>
        <div class="input-group">
            <label for="student-name">å§“å (Nama)ï¼š</label>
            <input type="text" id="student-name" placeholder="è¯·è¾“å…¥ä½ çš„åå­—..." autocomplete="off">
        </div>
        <div class="input-group">
            <label for="student-class">ç­çº§ (Kelas)ï¼š</label>
            <select id="student-class">
                <option value="">è¯·é€‰æ‹©ç­çº§</option>
                <option value="4M">4M</option>
                <option value="4K">4K</option>
                <option value="4B">4B</option>
                <option value="4H">4H</option>
                <option value="4J">4J</option>
                <option value="4U">4U</option>
                <option value="4P">4P</option>
                <option value="4C">4C</option>
            </select>
        </div>
        <button id="startBtn">å¼€å§‹æŒ‘æˆ˜</button>
    </div>

    <div id="quiz-content">
        <div id="student-info-bar">
            <span id="display-name">å­¦ç”Ÿï¼š-</span>
            <span id="display-class">ç­çº§ï¼š-</span>
        </div>
        <div id="pageArea"></div>
        <div class="result-bar" id="score">ğŸŒŸ æ­£ç¡®ï¼š0 / å·²ç­”ï¼š0</div>
    </div>

  </div>

<script>
// ====== ä½ çš„ Apps Script éƒ¨ç½²ç½‘å€ ======
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzc4UxSedlaqNGipAPr7oHQszCpJbPhoVZl5os2pVWRtnBedeyD_TuWwbOnCeC490hs/exec";

// ====== é¢˜ç›®æ•°æ® ======
const questions = [
  {q:'å“¥å“¥åšäº‹æ€»æ˜¯______ï¼Œé‡åˆ°ä¸€ç‚¹å›°éš¾å°±æ”¾å¼ƒï¼Œæ‰€ä»¥åˆ°ç°åœ¨ä¸€äº‹æ— æˆã€‚',
   o:['åšæŒä¸æ‡ˆ','åŠé€”è€ŒåºŸ','åºŸå¯å¿˜é£Ÿ','é”²è€Œä¸èˆ'], a:1},

  {q:'è¿™é‡Œçš„é£æ™¯______ï¼Œæœ‰å±±æœ‰æ°´ï¼Œè¿˜æœ‰è®¸å¤šç¾ä¸½çš„èŠ±æœµã€‚',
   o:['é¸Ÿè¯­èŠ±é¦™','æƒŠæ¶›éª‡æµª','ç‹‚é£æš´é›¨','ä¹ŒçƒŸç˜´æ°”'], a:0},

  {q:'æ–°å¹´æœŸé—´ï¼Œç‰›è½¦æ°´å¤§è¡—ä¸Š______ï¼Œéå¸¸çƒ­é—¹ã€‚',
   o:['é—¨å¯ç½—é›€','è½¦æ°´é©¬é¾™','è’æ— äººçƒŸ','äº•äº•æœ‰æ¡'], a:1},

  {q:'åªè¦æˆ‘ä»¬______ï¼Œä¸€å®šèƒ½æ‰“è´¥å¯¹æ‰‹ï¼Œèµ¢å¾—è¿™åœºæ‹”æ²³æ¯”èµ›ã€‚',
   o:['å­¤æŒéš¾é¸£','åŒå¿ƒååŠ›','è‡ªç›¸æ®‹æ€','å„å¥”å‰ç¨‹'], a:1},

  {q:'è¿™ç§______çš„è¡Œä¸ºæ˜¯ä¸å¯¹çš„ï¼Œæˆ‘ä»¬åº”è¯¥è¦æŠŠåˆ«äººçš„æ©æƒ è®°åœ¨å¿ƒé‡Œã€‚',
   o:['å¿˜æ©è´Ÿä¹‰','åŠ©äººä¸ºå¿«ä¹ä¹‹æœ¬','é¥®æ°´æ€æº','æ„Ÿæ©å›¾æŠ¥'], a:0},

  {q:'ä»–æ˜æ˜ä¸ä¼šå¹ç¬›å­ï¼Œå´æ··åœ¨ä¹é˜Ÿé‡Œ______ã€‚',
   o:['ç”»è›‡æ·»è¶³','æ»¥ç«½å……æ•°','æ¯å¼“è›‡å½±','æ©è€³ç›—é“ƒ'], a:1},

  {q:'å¬åˆ°è€å¸ˆçš„æé—®ï¼ŒåŒå­¦ä»¬éƒ½äº‰å…ˆæååœ°å›ç­”ï¼Œåªæœ‰å°æ˜______åœ°ååœ¨ä¸€æ—ã€‚',
   o:['ä¸ƒæ‰‹å…«è„š','æ»”æ»”ä¸ç»','æ²‰é»˜å¯¡è¨€','å£è‹¥æ‚¬æ²³'], a:2},

  {q:'â€œå½¢å®¹ä¸€ä¸ªäººè§è¯†å¾ˆå°‘ï¼Œå°±åƒä½åœ¨äº•é‡Œçš„é’è›™ä¸€æ ·ã€‚â€ æ˜¯æŒ‡å“ªä¸€ä¸ªæˆè¯­ï¼Ÿ',
   o:['äº•åº•ä¹‹è›™','ç›²äººæ‘¸è±¡','å®ˆæ ªå¾…å…”','äº¡ç¾Šè¡¥ç‰¢'], a:0},

  {q:'æ—¢ç„¶ä½ å·²ç»çŸ¥é“é”™äº†ï¼Œç°åœ¨______è¿˜ä¸ç®—å¤ªè¿Ÿã€‚',
   o:['å°†é”™å°±é”™','æ‰§è¿·ä¸æ‚Ÿ','äº¡ç¾Šè¡¥ç‰¢','è‡ªæŠ•ç½—ç½‘'], a:2},

  {q:'å¼Ÿå¼Ÿå¦‚æœä¸æ”¹æ‰______çš„åä¹ æƒ¯ï¼Œå°†æ¥ä¸€å®šä¼šåƒå¤§äºã€‚',
   o:['ä¸€ä¸ä¸è‹Ÿ','ç²—å¿ƒå¤§æ„','ç²¾ç›Šæ±‚ç²¾','å®äº‹æ±‚æ˜¯'], a:1},

  {q:'è¿™ä½ç”»å®¶çš„ç”»å·¥ç²¾æ¹›ï¼Œç”»å‡ºæ¥çš„è€è™______ï¼Œå¥½åƒçœŸçš„ä¸€æ ·ã€‚',
   o:['æ ©æ ©å¦‚ç”Ÿ','ç”»è›‡æ·»è¶³','å¼ ç‰™èˆçˆª','å‘†è‹¥æœ¨é¸¡'], a:0},

  {q:'è€ƒè¯•æ—¶ï¼Œè¯¾å®¤é‡Œ______ï¼Œè¿ä¸€æ ¹é’ˆæ‰åœ¨åœ°ä¸Šçš„å£°éŸ³éƒ½å¬å¾—è§ã€‚',
   o:['éœ‡è€³æ¬²è‹','é¸¦é›€æ— å£°','äººå£°é¼æ²¸','çªƒçªƒç§è¯­'], a:1},

  {q:'åªè¦ä½ æœ‰æ’å¿ƒï¼Œ______ï¼Œæœ€åä¸€å®šèƒ½æŠŠé“æµç£¨æˆç»£èŠ±é’ˆã€‚',
   o:['é“æ ‘å¼€èŠ±','æŒä¹‹ä»¥æ’','å¼‚æƒ³å¤©å¼€','æ˜™èŠ±ä¸€ç°'], a:1},

  {q:'çœ‹åˆ°è­¦å¯Ÿå‡ºç°ï¼Œé‚£äº›èµŒå¾’å“å¾—______ï¼Œå››å¤„é€ƒçªœã€‚',
   o:['ä»å®¹ä¸è¿«','æŠ±å¤´é¼ çªœ','å®‰ç„¶æ— æ™','æŒºèº«è€Œå‡º'], a:1},

  {q:'ä¸‹åˆ—å“ªä¸€ä¸ªæˆè¯­ç”¨æ¥å½¢å®¹â€œæœ‹å‹ä¹‹é—´æ·±åšçš„å‹æƒ…â€ï¼Ÿ',
   o:['æƒ…åŒæ‰‹è¶³','åŠ¿ä¸ä¸¤ç«‹','æ°´ç«ä¸å®¹','è§åˆ©å¿˜ä¹‰'], a:0},

  {q:'è¿™ä¸ªé­”æœ¯è¡¨æ¼”çœŸæ˜¯______ï¼Œçœ‹å¾—è§‚ä¼—ç›®çªå£å‘†ã€‚',
   o:['å¹³æ·¡æ— å¥‡','æ¯ç‡¥ä¹å‘³','åƒå˜ä¸‡åŒ–','ä¸€æˆä¸å˜'], a:2},

  {q:'ä¸ºäº†å‡†å¤‡æ˜å¤©çš„è€ƒè¯•ï¼Œå§å§æ˜¨æ™š______åœ°å¤ä¹ åŠŸè¯¾ã€‚',
   o:['æ¸¸æ‰‹å¥½é—²','åºŸå¯å¿˜é£Ÿ','æ— æ‰€äº‹äº‹','å¿ƒä¸åœ¨ç„‰'], a:1},

  {q:'å°åè™½ç„¶æˆç»©ä¼˜å¼‚ï¼Œä½†ä»–ä»ä¸éª„å‚²ï¼Œæ€»æ˜¯______åœ°å‘åŒå­¦è¯·æ•™ã€‚',
   o:['è™šæ€€è‹¥è°·','ç››æ°”å‡Œäºº','éª„å…µå¿…è´¥','è¶¾é«˜æ°”æ‰¬'], a:0},

  {q:'é‚£æ ‹åºŸå¼ƒçš„å±‹å­é˜´æ£®æ£®çš„ï¼Œè®©äººæ„Ÿåˆ°______ã€‚',
   o:['å…´é«˜é‡‡çƒˆ','æ¯›éª¨æ‚šç„¶','å¿ƒèŠ±æ€’æ”¾','çœ‰å¼€çœ¼ç¬‘'], a:1},

  {q:'æˆ‘ä»¬è¯´è¯è¦______ï¼Œç­”åº”åˆ«äººçš„äº‹å°±ä¸€å®šè¦åšåˆ°ã€‚',
   o:['å£æ˜¯å¿ƒé','è¨€è€Œæ— ä¿¡','è¨€å‡ºå¿…è¡Œ','ä¿¡å£å¼€æ²³'], a:2}
];

// ====== å…¨å±€å˜é‡ ======
const selected = Array(questions.length).fill(null);
const answers = Array(questions.length).fill(null);
let studentName = "";
let studentClass = "";

// ====== DOM å…ƒç´  ======
const startScreen = document.getElementById('start-screen');
const quizContent = document.getElementById('quiz-content');
const startBtn = document.getElementById('startBtn');
const nameInput = document.getElementById('student-name');
const classInput = document.getElementById('student-class');
const displayName = document.getElementById('display-name');
const displayClass = document.getElementById('display-class');
const pageArea = document.getElementById('pageArea');
const scoreEl = document.getElementById('score');

// ====== 1. å¼€å§‹æŒ‰é’®é€»è¾‘ ======
startBtn.addEventListener('click', () => {
    const sName = nameInput.value.trim();
    const sClass = classInput.value;

    if (!sName) {
        alert("è¯·è¾“å…¥ä½ çš„åå­—ï¼");
        return;
    }
    if (!sClass) {
        alert("è¯·é€‰æ‹©ä½ çš„ç­çº§ï¼");
        return;
    }

    studentName = sName;
    studentClass = sClass;

    // åˆ‡æ¢ç•Œé¢
    startScreen.style.display = 'none';
    quizContent.style.display = 'block';

    // æ˜¾ç¤ºä¿¡æ¯
    displayName.textContent = `å­¦ç”Ÿï¼š${studentName}`;
    displayClass.textContent = `ç­çº§ï¼š${studentClass}`;

    // æ¸²æŸ“é¢˜ç›®
    render();
});

// ====== 2. æ¸²æŸ“ä¸ç­”é¢˜é€»è¾‘ ======
function render(){
  pageArea.innerHTML='';
  questions.forEach((q,i)=>{
    const card=document.createElement('div');
    card.className='card';
    
    // é¢˜ç›®æ–‡æœ¬
    const qText=document.createElement('div');
    qText.className='q';
    qText.textContent=`${i+1}. ${q.q}`;
    card.appendChild(qText);

    // é€‰é¡¹å®¹å™¨
    const opts=document.createElement('div');
    opts.className='choices';
    
    q.o.forEach((opt,idx)=>{
      const b=document.createElement('button');
      b.className='choice';
      b.textContent=opt;
      b.addEventListener('click',()=>{
        if(answers[i]!==null) return; // é˜²æ­¢é‡å¤ç­”é¢˜
        selected[i]=idx;
        checkAnswer(i,card,opts);
      });
      opts.appendChild(b);
    });
    card.appendChild(opts);
    pageArea.appendChild(card);
  });
}

function checkAnswer(i,card,opts){
  const q=questions[i];
  const chosen=selected[i];
  const btns=opts.querySelectorAll('.choice');
  
  // ç¦ç”¨æ‰€æœ‰æŒ‰é’®
  btns.forEach(b=>b.disabled=true);

  if(chosen===q.a){
    // ç­”å¯¹äº†
    btns[chosen].classList.add('correct');
    answers[i]=true;
  }else{
    // ç­”é”™äº†
    btns[chosen].classList.add('wrong');
    const correctBtn=btns[q.a];
    correctBtn.classList.add('correct-flash');
    setTimeout(()=>{
      correctBtn.classList.remove('correct-flash');
      correctBtn.classList.add('correct');
    },700);
    answers[i]=false;
  }
  updateScore();
  
  // æ£€æŸ¥æ˜¯å¦å…¨éƒ¨ç­”å®Œ
  checkCompletion();
}

function updateScore(){
  const correctCount=answers.filter(v=>v===true).length;
  const answeredCount=answers.filter(v=>v!==null).length;
  // å¦‚æœè¿˜åœ¨ç­”é¢˜ä¸­ï¼Œæ˜¾ç¤ºè¿›åº¦
  if(answeredCount < questions.length) {
     scoreEl.textContent=`ğŸŒŸ æ­£ç¡®ï¼š${correctCount} / å·²ç­”ï¼š${answeredCount} (å…±${questions.length}é¢˜)`;
  }
}

// ====== 3. æäº¤æ•°æ®åˆ° Google Sheet (æ–°å¢) ======
function submitToGoogleSheet(name, className, score, total) {
    // 1. æ›´æ–°UIæ˜¾ç¤ºæ­£åœ¨æäº¤
    scoreEl.style.backgroundColor = "#fff3e0";
    scoreEl.innerHTML = `â³ æ­£åœ¨æäº¤æˆç»©ï¼Œè¯·ç¨å€™...`;

    // 2. å‡†å¤‡æ•°æ®
    const formData = new URLSearchParams();
    formData.append("name", name);
    formData.append("class", className);
    formData.append("score", score);
    formData.append("total", total);

    // 3. å‘é€è¯·æ±‚
    fetch(SCRIPT_URL, {
        method: 'POST',
        body: formData
    })
    .then(response => {
        // Apps Script æœ‰æ—¶è¿”å›è·³è½¬ï¼Œä½† fetch é€šå¸¸èƒ½å¤„ç†
        return response.text(); 
    })
    .then(text => {
        // æˆåŠŸåçš„å¤„ç†
        scoreEl.style.backgroundColor = "#e8f5e9";
        scoreEl.style.borderColor = "#4caf50";
        scoreEl.style.color = "#1b5e20";
        scoreEl.innerHTML = `âœ… æˆç»©å·²å­˜æ¡£ï¼å¾—åˆ†ï¼š${score}/${total}`;
        
        alert(`ğŸ‰ æ­å–œ ${name} (${className})ï¼\n\nä½ çš„æˆç»©å·²æˆåŠŸå‘é€ç»™è€å¸ˆã€‚\næ€»å¾—åˆ†ï¼š${score} / ${total}`);
    })
    .catch(error => {
        // é”™è¯¯å¤„ç†
        console.error('Error:', error);
        scoreEl.innerHTML = `âš ï¸ æäº¤é‡åˆ°ç½‘ç»œé—®é¢˜ï¼Œè¯·æˆªå›¾ä¿å­˜ã€‚`;
        alert(`è™½ç„¶ç­”é¢˜å®Œæˆäº†ï¼Œä½†æäº¤æˆç»©æ—¶ç½‘ç»œæœ‰ç‚¹å¡ã€‚\n\nè¯·æˆªå›¾æ­¤ç”»é¢å‘ç»™è€å¸ˆï¼š\nå§“åï¼š${name}\nåˆ†æ•°ï¼š${score}/${total}`);
    });
}

function checkCompletion() {
    const answeredCount = answers.filter(v => v !== null).length;
    if (answeredCount === questions.length) {
        const correctCount = answers.filter(v => v === true).length;
        
        // å»¶è¿Ÿä¸€ç‚¹ç‚¹ï¼Œè®©åŠ¨ç”»æ’­å®Œå†æäº¤
        setTimeout(() => {
            submitToGoogleSheet(studentName, studentClass, correctCount, questions.length);
        }, 800);
    }
}
</script>
</body>
</html>
