<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>ä¸€å¹´çº§è¯­æ–‡è¶£å‘³ç»ƒä¹  Â· æ¢¦å¹»æŸ”å½©èƒŒæ™¯ç‰ˆ</title>
<style>
  :root{
    --card-bg: rgba(255,255,255,0.95);
    --text:#4a2c2a;
    --blue:#64b5f6;
    --green:#81c784;
    --red:#e57373;
    --orange:#ff7043;
    --brown:#3e2723;
  }
  body{
    margin:0;padding:0;
    font-family:'Ma Shan Zheng','Comic Neue','Microsoft YaHei',sans-serif;
    background-size:cover;background-position:center;
    background-image:url('https://wallpapercave.com/wp/wp6938327.jpg');
    color:var(--text);
    min-height:100vh;
  }
  h1{text-align:center;color:#ff7043;text-shadow:2px 2px 0 #ffe0b2;margin:16px 0 6px;font-size:2rem}
  .wrap{max-width:820px;margin:auto;padding:12px}
  
  /* ====== é€šç”¨å¡ç‰‡æ ·å¼ ====== */
  .card{
    background:var(--card-bg);
    border-radius:20px;
    padding:18px;
    margin:16px auto;
    box-shadow:0 10px 30px rgba(0,0,0,0.1);
    transition:transform 260ms ease;
  }
  .card:hover{transform:translateY(-6px)}

  /* ====== 1. å¼€å§‹ç”»é¢æ ·å¼ ====== */
  #start-screen {
    max-width: 450px;
    text-align: center;
    padding: 30px 25px;
    margin-top: 50px;
    border: 3px solid #ffcc80;
  }
  
  .input-group {
    margin-bottom: 20px;
    text-align: left;
  }
  .input-group label {
    display: block;
    font-size: 1.2rem;
    margin-bottom: 8px;
    font-weight: bold;
    color: var(--brown);
  }
  .input-group input, .input-group select {
    width: 100%;
    padding: 12px;
    font-size: 1.1rem;
    border: 2px solid #ffcc80;
    border-radius: 15px;
    box-sizing: border-box;
    outline: none;
    font-family: inherit;
    background-color: #fffde7;
    color: var(--brown);
  }
  .input-group input:focus, .input-group select:focus {
    border-color: #ff7043;
    background-color: #fff;
  }

  #startBtn {
    font-size: 1.5rem;
    padding: 12px 50px;
    background: linear-gradient(to bottom, #ff7043, #d84315);
    color: white;
    border: none;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 5px 0 #bf360c;
    transition: transform 0.1s;
    margin-top: 10px;
    font-family: inherit;
    letter-spacing: 2px;
  }
  #startBtn:active { transform: translateY(3px); box-shadow: none; }

  /* ====== 2. ç»ƒä¹ å†…å®¹åŒºåŸŸ ====== */
  #quiz-content { display: none; }

  #student-info-bar {
    background: rgba(255, 255, 255, 0.9);
    padding: 10px 20px;
    border-radius: 15px;
    margin-bottom: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: bold;
    color: var(--brown);
    border-left: 5px solid #ff7043;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
  }

  /* ====== é¢˜ç›®ä¸é€‰é¡¹ ====== */
  .q{font-size:1.3rem;margin-bottom:12px; line-height: 1.5;}
  .choices{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}
  .choice{
    min-width:120px;
    padding:10px 16px;
    border:none;border-radius:16px;
    font-size:1rem;
    cursor:pointer;
    color:#3e2723;
    background:linear-gradient(to bottom,#fff3e0,#ffe0b2);
    box-shadow:0 6px 0 rgba(0,0,0,0.12);
    transition:transform .2s, background .2s;
    font-family: inherit;
  }
  .choice:hover{transform:translateY(-3px)}
  
  .choice.correct{background:linear-gradient(to bottom,#a5d6a7,#66bb6a);color:#1b5e20; box-shadow: none; cursor: default;}
  .choice.wrong{background:linear-gradient(to bottom,#ef9a9a,#e57373);color:#b71c1c; box-shadow: none; cursor: default;}
  .choice:disabled { cursor: default; }

  /* ====== åº•éƒ¨ç»“æœæ  ====== */
  .result-bar {
    position: sticky;
    bottom: 20px;
    background: rgba(255, 255, 255, 0.95);
    padding: 12px 20px;
    border-radius: 50px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    text-align: center;
    font-weight:bold;
    font-size:1.2rem;
    color: #d84315;
    border: 2px solid #ffcc80;
    max-width: 400px;
    margin: 20px auto;
    z-index: 100;
  }

  @keyframes flashGreen{0%{transform:scale(1)}40%{transform:scale(1.06)}100%{transform:scale(1)}}
  .correct-flash{animation:flashGreen 700ms ease;}
</style>
</head>
<body>
  <h1>ğŸŒˆ ä¸€å¹´çº§è¯­æ–‡è¶£å‘³ç»ƒä¹ </h1>
  
  <div class="wrap">
    
    <div id="start-screen" class="card">
        <h2 style="color:#d84315; margin-top:0;">âœ¨ æ¬¢è¿å°æœ‹å‹ âœ¨</h2>
        <div class="input-group">
            <label for="student-name">ä½ çš„åå­— (Nama)ï¼š</label>
            <input type="text" id="student-name" placeholder="è¯·è¾“å…¥åå­—..." autocomplete="off">
        </div>
        <div class="input-group">
            <label for="student-class">ä½ çš„ç­çº§ (Kelas)ï¼š</label>
            <select id="student-class">
                <option value="">è¯·é€‰æ‹©ç­çº§</option>
                <option value="1M">1M</option>
                <option value="1K">1K</option>
                <option value="1B">1B</option>
                <option value="1H">1H</option>
                <option value="1J">1J</option>
                <option value="1U">1U</option>
                <option value="1P">1P</option>
                <option value="1C">1C</option>
            </select>
        </div>
        <button id="startBtn">å¼€å§‹ç»ƒä¹ </button>
    </div>

    <div id="quiz-content">
        <div id="student-info-bar">
            <span id="display-name">å­¦ç”Ÿï¼š-</span>
            <span id="display-class">ç­çº§ï¼š-</span>
        </div>
        <div id="pageArea"></div>
        <div class="result-bar" id="score">ğŸŒŸ æ­£ç¡®ï¼š0 / å·²ç­”ï¼š0</div>
    </div>

  </div>

<script>
// ====== ä½ çš„æ–° Google Apps Script é“¾æ¥ ======
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbylneTp2mlQwFFw8PkJPxXDwkT5s1szYTK52AKG6s1eK5M92ajsw-SRnCEAzSSIOnf6qw/exec";

const questions = [
  {q:'é‚£ä¸ªå…³äºå‹è°Šçš„æ•…äº‹è•´å«ç€æ·±åˆ»çš„______ã€‚',o:['åˆšå·§','é“ç†','å®è´'],a:1},
  {q:'å¤ªé˜³ä»ä¸œæ–¹æ…¢æ…¢åœ°______æ¥äº†ã€‚',o:['è¸¢çƒ','æŠ±ç€','å‡èµ·'],a:2},
  {q:'å¦ˆå¦ˆç´§ç´§åœ°______ç€æ€€é‡Œçš„å­©å­ã€‚',o:['å¥¶å¥¶','æŠ±ç€','ä¼‘æ¯'],a:1},
  {q:'å¼Ÿå¼Ÿåœ¨å…¬å›­é‡Œé«˜å…´åœ°______ã€‚',o:['è¸¢çƒ','èŒ¶æ¯','å‡èµ·'],a:0},
  {q:'è€å¸ˆç»™æˆ‘ä»¬è®²äº†è®¸å¤šåšäººçš„______ã€‚',o:['å› ä¸º','é“ç†','å®è´'],a:1},
  {q:'ä»–ä»Šå¤©______è·¯è¿‡æˆ‘çš„å®¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èµ·åƒäº†é¥­ã€‚',o:['åˆšå·§','å‡èµ·','ä¼‘æ¯'],a:0},
  {q:'è¿™ä¸ªå°ç‹—æ˜¯æˆ‘æœ€å¿ƒçˆ±çš„______ã€‚',o:['èŒ¶æ¯','å®è´','è¸¢çƒ'],a:1},
  {q:'______ä¸‹é›¨äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å–æ¶ˆäº†é‡é¤è®¡åˆ’ã€‚',o:['åˆšå·§','å› ä¸º','å¥¶å¥¶'],a:1},
  {q:'è·‘äº†è¿™ä¹ˆä¹…ï¼Œæˆ‘ä»¬åº”è¯¥åœä¸‹æ¥______ä¸€ä¸‹äº†ã€‚',o:['ä¼‘æ¯','é“ç†','æŠ±ç€'],a:0},
  {q:'è¯·ä½ å¸®æˆ‘æŠŠæ¡Œä¸Šçš„______é€’ç»™æˆ‘ã€‚',o:['å®è´','å‡èµ·','èŒ¶æ¯'],a:2},

  /* ä»¥ä¸‹ä¸ºæ–°å¢é¢˜ç›® */
  {q:'å°æ˜çœ‹åˆ°å¤©ç©ºå‡ºç°äº†ä¸€é“ç¾ä¸½çš„______ã€‚',o:['å½©è™¹','èŒ¶æ¯','ä¼‘æ¯'],a:0},
  {q:'å°çº¢æŠŠæ‰¾åˆ°çš„å°çŒ«å½“ä½œè‡ªå·±çš„______ä¸€æ ·ç…§é¡¾ã€‚',o:['åˆšå·§','å®è´','é“ç†'],a:1},
  {q:'æ—©ä¸Šï¼Œå…¬é¸¡ä¸€å«ï¼Œçˆ¸çˆ¸å°±ä»åºŠä¸Š______æ¥äº†ã€‚',o:['å¥¶å¥¶','å‡èµ·','åèµ·'],a:2},
  {q:'å¦¹å¦¹åœ¨é™¢å­é‡Œå¼€å¿ƒåœ°______ç€æ³¡æ³¡ã€‚',o:['ä¼‘æ¯','è¿½','æŠ±ç€'],a:1},
  {q:'å› ä¸ºå¤©æ°”å¾ˆå¥½ï¼Œæˆ‘ä»¬å†³å®šå»å…¬å›­é‡Œ______ã€‚',o:['ç©è€','å®è´','èŒ¶æ¯'],a:0},
  {q:'å¦ˆå¦ˆè½»è½»åœ°______æˆ‘çš„å¤´å‘ã€‚',o:['å‡èµ·','æŠšæ‘¸','åˆšå·§'],a:1},
  {q:'ä¸‹è¯¾åï¼ŒåŒå­¦ä»¬éƒ½è·‘åˆ°æ“åœºä¸Šå»______ã€‚',o:['ä¼‘æ¯','è¸¢çƒ','å¥¶å¥¶'],a:1},
  {q:'é›¨åœäº†ï¼Œå¤©ç©ºå˜å¾—ååˆ†______ã€‚',o:['æ˜äº®','è¸¢çƒ','é“ç†'],a:0},
  {q:'å“¥å“¥æŠŠä½œä¸šæœ¬æ”¾è¿›______é‡Œå¸¦å»å­¦æ ¡ã€‚',o:['ä¹¦åŒ…','èŒ¶æ¯','ä¼‘æ¯'],a:0},
  {q:'ä»Šå¤©çš„å¤ªé˜³ç‰¹åˆ«______ï¼Œç…§å¾—äººæš–æ´‹æ´‹çš„ã€‚',o:['æ˜äº®','åˆšå·§','é“ç†'],a:0}
];

// ====== å…¨å±€å˜é‡ ======
const selected = Array(questions.length).fill(null);
const answers = Array(questions.length).fill(null);
let studentName = "";
let studentClass = "";

// ====== DOM å…ƒç´  ======
const startScreen = document.getElementById('start-screen');
const quizContent = document.getElementById('quiz-content');
const startBtn = document.getElementById('startBtn');
const nameInput = document.getElementById('student-name');
const classInput = document.getElementById('student-class');
const displayName = document.getElementById('display-name');
const displayClass = document.getElementById('display-class');
const pageArea = document.getElementById('pageArea');
const scoreEl = document.getElementById('score');

// ====== 1. ç‚¹å‡»å¼€å§‹æŒ‰é’® ======
startBtn.addEventListener('click', () => {
    const sName = nameInput.value.trim();
    const sClass = classInput.value;

    if (!sName) {
        alert("å°æœ‹å‹ï¼Œè¯·å…ˆè¾“å…¥ä½ çš„åå­—å“¦ï¼");
        return;
    }
    if (!sClass) {
        alert("è¯·é€‰æ‹©ä½ çš„ç­çº§ï¼");
        return;
    }

    studentName = sName;
    studentClass = sClass;

    // åˆ‡æ¢ç•Œé¢
    startScreen.style.display = 'none';
    quizContent.style.display = 'block';
    
    // æ˜¾ç¤ºå­¦ç”Ÿä¿¡æ¯
    displayName.textContent = `å­¦ç”Ÿï¼š${studentName}`;
    displayClass.textContent = `ç­çº§ï¼š${studentClass}`;

    // ç”Ÿæˆé¢˜ç›®
    render();
});

// ====== 2. æ¸²æŸ“é¢˜ç›® ======
function render(){
  pageArea.innerHTML='';
  questions.forEach((q,i)=>{
    const card=document.createElement('div');
    card.className='card';
    const qText=document.createElement('div');
    qText.className='q';
    qText.textContent=`${i+1}. ${q.q}`;
    card.appendChild(qText);

    const opts=document.createElement('div');
    opts.className='choices';
    q.o.forEach((opt,idx)=>{
      const b=document.createElement('button');
      b.className='choice';
      b.textContent=opt;
      b.addEventListener('click',()=>{
        if(answers[i]!==null) return;
        selected[i]=idx;
        checkAnswer(i,card,opts);
      });
      opts.appendChild(b);
    });
    card.appendChild(opts);
    pageArea.appendChild(card);
  });
}

// ====== 3. æ£€æŸ¥ç­”æ¡ˆ ======
function checkAnswer(i,card,opts){
  const q=questions[i];
  const chosen=selected[i];
  const btns=opts.querySelectorAll('.choice');
  
  // ç¦ç”¨æ‰€æœ‰æŒ‰é’®
  btns.forEach(b=>b.disabled=true);

  if(chosen===q.a){
    btns[chosen].classList.add('correct');
    answers[i]=true;
  }else{
    btns[chosen].classList.add('wrong');
    const correctBtn=btns[q.a];
    correctBtn.classList.add('correct-flash');
    setTimeout(()=>{
      correctBtn.classList.remove('correct-flash');
      correctBtn.classList.add('correct');
    },700);
    answers[i]=false;
  }
  updateScore();
  
  // æ£€æŸ¥æ˜¯å¦å…¨éƒ¨ç­”å®Œ
  checkCompletion();
}

function updateScore(){
  const correctCount=answers.filter(v=>v===true).length;
  const answeredCount=answers.filter(v=>v!==null).length;
  // å¦‚æœæœªå®Œæˆï¼Œæ˜¾ç¤ºè¿›åº¦
  if(answeredCount < questions.length) {
     scoreEl.textContent=`ğŸŒŸ æ­£ç¡®ï¼š${correctCount} / å·²ç­”ï¼š${answeredCount} (å…±${questions.length}é¢˜)`;
  }
}

// ====== 4. æäº¤æ•°æ®åˆ° Google Sheet ======
function submitToGoogleSheet(name, className, score, total) {
    // UI çŠ¶æ€æ›´æ–°ï¼šæ­£åœ¨æäº¤
    scoreEl.style.backgroundColor = "#fffde7";
    scoreEl.innerHTML = `â³ æ­£åœ¨æäº¤æˆç»©ï¼Œè¯·ç¨å€™...`;

    // å‡†å¤‡æ•°æ®
    const formData = new URLSearchParams();
    formData.append("name", name);
    formData.append("class", className);
    formData.append("score", score);
    formData.append("total", total);

    // å‘é€è¯·æ±‚
    fetch(SCRIPT_URL, {
        method: 'POST',
        body: formData
    })
    .then(response => response.text())
    .then(text => {
        // æˆåŠŸçŠ¶æ€
        scoreEl.style.backgroundColor = "#e8f5e9";
        scoreEl.style.borderColor = "#66bb6a";
        scoreEl.style.color = "#2e7d32";
        scoreEl.innerHTML = `âœ… æˆç»©æäº¤æˆåŠŸï¼å¾—åˆ†ï¼š${score}/${total}`;
        
        alert(`ğŸ‰ å¤ªæ£’äº† ${name}ï¼\n\nä½ å®Œæˆäº†æ‰€æœ‰ç»ƒä¹ ã€‚\nä½ çš„åˆ†æ•° (${score}/${total}) å·²ç»å‘é€ç»™è€å¸ˆäº†ï¼`);
    })
    .catch(error => {
        // é”™è¯¯å¤„ç†
        console.error('Error:', error);
        scoreEl.innerHTML = `âš ï¸ ç½‘ç»œæœ‰ç‚¹å¡ï¼Œè¯·æˆªå›¾ç»™è€å¸ˆã€‚`;
        alert(`ç»ƒä¹ å®Œæˆï¼ä½†æäº¤æˆç»©æ—¶ç½‘ç»œæœ‰ç‚¹å¡ã€‚\n\nè¯·æŠŠè¿™ä¸ªç”»é¢æˆªå›¾å‘ç»™è€å¸ˆï¼š\nå§“åï¼š${name}\nåˆ†æ•°ï¼š${score}/${total}`);
    });
}

function checkCompletion() {
    const answeredCount = answers.filter(v => v !== null).length;
    if (answeredCount === questions.length) {
        const correctCount = answers.filter(v => v === true).length;
        
        // ç¨ç­‰ä¸€ä¼šå†æäº¤ï¼Œè®©å­¦ç”Ÿçœ‹åˆ°æœ€åä¸€é¢˜çš„åé¦ˆ
        setTimeout(() => {
            submitToGoogleSheet(studentName, studentClass, correctCount, questions.length);
        }, 800);
    }
}
</script>
</body>
</html>
